# 12306火车票预订系统 Web版

这是一个基于Python Flask的12306火车票预订系统的Web界面版本，提供了完整的图形化操作界面。

## 功能特性

- ✅ 扫码登录12306账户
- ✅ 车站搜索和车票查询
- ✅ 乘客信息管理和选择
- ✅ 座位类型选择（二等座、一等座、商务座、无座）
- ✅ 在线提交订单
- ✅ 实时状态反馈

## 系统架构

```
项目结构:
├── app.py              # Flask后端主程序
├── main.py             # 核心订票逻辑
├── test.py             # 登录模块
├── stations.py         # 车站管理
├── stations.json       # 车站数据
├── templates/
│   └── index.html      # 前端主页面
└── static/
    ├── css/
    │   └── style.css   # 样式文件
    └── js/
        └── main.js     # 前端JavaScript逻辑
```

## 安装和运行

### 1. 环境要求
- Python 3.8+
- Redis服务器（可选，用于登录状态缓存）

### 2. 安装依赖
```bash
# 激活虚拟环境（如果使用）
source .venv/bin/activate

# 安装必要依赖
pip install flask flask-cors redis pillow curl_cffi requests
```

### 3. 启动应用
```bash
# 启动Flask应用
python app.py

# 应用将在 http://localhost:5001 启动
```

### 4. 访问系统
打开浏览器访问 `http://localhost:5001`

## 使用指南

### 1. 登录系统
- 点击右上角"登录"按钮
- 使用12306手机APP扫描二维码
- 在手机上确认登录

### 2. 查询车票
- 输入出发站和到达站
- 选择出行日期
- 点击"查询车票"按钮

### 3. 选择车次和乘客
- 从查询结果中选择合适的车次
- 在左侧选择乘车乘客
- 选择座位类型

### 4. 提交订单
- 点击"提交订单"按钮
- 系统会自动完成订票流程
- 成功后请立即在12306 APP中完成支付

## API接口说明

### 登录相关
- `POST /api/login/qrcode` - 获取登录二维码
- `GET /api/login/status/<uuid>` - 检查登录状态
- `GET /api/user/status` - 检查用户登录状态

### 查询相关
- `GET /api/stations` - 获取车站列表
- `POST /api/tickets/query` - 查询车票信息

### 订票相关
- `GET /api/passengers` - 获取乘客列表
- `POST /api/booking/submit` - 提交订单

## 注意事项

1. **登录有效期**：登录状态会保持一段时间，过期后需要重新登录
2. **网络要求**：需要能够访问12306官方网站
3. **实名认证**：订票需要已通过12306实名认证的账户
4. **支付提醒**：下单成功后需及时在12306 APP中完成支付
5. **频率限制**：避免过于频繁的查询操作，以免触发风控

## 故障排除

### 常见问题

1. **无法获取二维码**
   - 检查网络连接
   - 确认能够访问12306网站

2. **登录失败**
   - 重新扫描二维码
   - 检查手机APP版本是否最新

3. **查询无结果**
   - 检查车站名称是否正确
   - 确认出行日期是否合理
   - 部分热门线路可能无票

4. **下单失败**
   - 检查登录状态是否有效
   - 确认选择的车次仍有余票
   - 检查乘客信息是否完整

### 日志查看
可以通过终端输出查看详细的运行日志和错误信息。

## 开发说明

### 技术栈
- **后端**：Python + Flask
- **前端**：HTML5 + CSS3 + JavaScript + Bootstrap 5
- **通信**：RESTful API + AJAX
- **依赖管理**：pip

### 代码结构
- `app.py` - Flask路由和API接口
- `main.py` - 核心订票逻辑实现
- `test.py` - 12306登录认证模块
- `stations.py` - 车站信息管理

### 扩展开发
可以根据需要扩展以下功能：
- 订单历史查询
- 自动抢票功能
- 多账户管理
- 票价比较
- 行程提醒

## 免责声明

本系统仅供学习交流使用，请遵守12306官方相关规定，不要用于商业用途。使用本系统产生的任何后果由使用者自行承担。

## 版本信息

- 当前版本：1.0.0
- 更新日期：2024年
- 开发环境：Python 3.10

---
如有问题或建议，请提交issue或联系开发者。